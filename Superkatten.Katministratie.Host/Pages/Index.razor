@page "/"
@using Superkatten.Katministratie.Host.Components.Helpers

<PageTitle>Superkatten</PageTitle>

@if (AuthenticationService is null 
    || Navigation is null 
    || SuperkattenService is null 
    || ReportingService is null
    || _loginModel is null)
{
  <Field>Initializing...</Field>
    return;
}


<Fields>
    <Field Padding="Padding.Is1">
        @if (AuthenticationService?.User is not null)
        {
          <Span>
            <span class="material-icons">face</span>
              <span>
                @AuthenticationService?.User.Name
              </span>
          </Span>
        }
        else
        {
          <Field>niet ingelogged</Field>
        }
    </Field>

    <Field TextAlignment="TextAlignment.End">
        <Button Clicked="@OnLoginLogout">
            @if (AuthenticationService.IsAuthenticated)
            {   
              <Tooltip Text="Logout">

                  <span class="material-icons">logout</span>
              </Tooltip>
            }
            else
            {
                <Tooltip Text="Login">
                    <span class="material-icons">face</span>
                </Tooltip>
            }
        </Button>
   
        <Button Clicked="@OnRegister">
            <Tooltip Text="Register">
                <span class="material-icons">
                    add_circle_outline
                </span>
            </Tooltip>
        </Button>
    </Field>
</Fields>

@if (!IsAuthenticated)
{
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnRegister">Register</Button>
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnLogin">Login</Button>
}
else
{
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnLogout">Logout</Button>

    <Divider />
    
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnCreateSuperkatPhoto">Maak foto</Button>
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnCreateSuperkat">Nieuwe kat</Button>
    
    <Divider />

    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnShowOverviewSuperkatten">Alle katten</Button>
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnShowNotNeutralized">Niet geneutraliseerde katten</Button>
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnShowOverviewGastgezinnen">Gastgezinnen</Button>
    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnShowMedicalProcedures">Medische handelingen</Button>

    <Divider /> 
    
    <HeaderItem Titel="Rapporten"/>

    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnEmailCageCard">
        Email mij een kooikaart
    </Button>

    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnCreateWakkerDierInventoryReport">
        Email wakker dier inventarisatie data
    </Button>

    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnNotNeutralizedInRefugeReport">
        Email niet geneutraliseerde katten in opvang
    </Button>

    <Button Block Size="Size.Large" Color="Color.Primary" Clicked="@OnNotNeutralizedAdopteesReport">
        Email niet geneutraliseerde geplaatste katten
    </Button>
}

@if (_loginModel is null)
{
    return;
}

<Modal @ref="_authenticationDialog">
    <ModalContent Centered>
        <ModalHeader>
            <ModalTitle>Inloggen</ModalTitle>
            <CloseButton />
        </ModalHeader>
        <ModalBody>            
            <Field>
                <FieldLabel>Gebruikersnaam</FieldLabel>
                <TextEdit Role="TextRole.Text" 
                            MaskType="MaskType.RegEx" 
                            EditMask="^[a-z]*$" 
                            @bind-Text="@_loginModel.Username" 
                            Placeholder="Vul de gebruikersnaam in..." 
                            KeyPress="@OnKeyPress"/>
            </Field>
            <Field>
                <FieldLabel>Wachtwoord</FieldLabel>
                <TextEdit Role="TextRole.Password" 
                            @bind-Text="@_loginModel.Password" 
                            Placeholder="Vul je wachtwoord in..."
                            KeyPress="@OnKeyPress"/>
            </Field>
        </ModalBody>
        <ModalFooter>
            <Button Color="Color.Secondary" Clicked="@HideModal">Sluiten</Button>
            <Button Color="Color.Primary" Clicked="@SaveAndHideModal">Ok</Button>
            
        </ModalFooter>
    </ModalContent>
</Modal>