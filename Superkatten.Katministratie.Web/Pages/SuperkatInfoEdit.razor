@page "/superkat/{SuperkatNumber:int}"

@using Superkatten.Katministratie.Application.Contracts
@using Superkatten.Katministratie.Web.Services

@inject NavigationManager _navigationManager

<Button Type="@ButtonType.Primary" OnClick="()=>OkClick()"/>

<Input Placeholder="Name" @bind-Value="@SuperkatName"  />
<Text>@SuperkatLocation</Text>

@code
{
    [Inject]
    private ISuperkattenListService _superkattenService { get; set; }

    [Parameter]
    public int SuperkatNumber { get; set; }

    public string SuperkatName { get; set; } = string.Empty;
    public int DaysOld { get; set; } = 1;

    public string SuperkatLocation => _superkatLocation;

    private string _superkatLocation = string.Empty;
    private int _daysOld = 1;

    protected override async Task OnInitializedAsync() 
    {
        var superkat = await _superkattenService.GetSuperkatAsync(SuperkatNumber);
        SuperkatName = superkat.Name == null ? string.Empty : superkat.Name;
        _superkatLocation = superkat.CatchLocation;
    }

    public async void OkClick()
    {
        var updateSuperkatParameters = new UpdateSuperkatParameters
        {
            Number = SuperkatNumber,
            Name = SuperkatName,
            DaysOld = _daysOld
        };
        await _superkattenService.UpdateSuperkatAsync(SuperkatNumber, updateSuperkatParameters);
        _navigationManager.NavigateTo($"/");
    }
}